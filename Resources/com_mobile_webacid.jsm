// copyright Websecurify, all rights reserved
(function(f){function b(a,b,c,d){this.workspace=a;this.scheduler=b;this.reporter=c;this.progressor=d;this.crawler=new e(this.workspace,50,!0);this.scope=g.createBasicScope();this.tracker=new h(this.workspace,this.scope,this.scheduler,this.crawler,50,!0);this.identifier=i.generateRandomString("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",5);this.fuzzer=new j(this.workspace,this.scheduler,this.identifier,!1,!1,!1);this.fuzzerCrawler=new e(this.workspace,50,!0);this.analyzer=new k(this.workspace);
this.tracker.registerObserver(this);this.fuzzer.registerObserver(this);this.fuzzerCrawler.registerObserver(this);this.analyzer.registerObserver(this)}var l=require("./org_basic_common.js"),c=require("./org_basic_http.js"),d=require("./org_basic_webacid.js"),i=l.StringUtils,m=c.Headers,n=c.Method,o=c.Request,p=c.SourceData,q=c.Version,r=c.PathFactory,s=c.UrlFactory,g=d.Scope,k=d.Analyzer,e=d.Crawler,j=d.Fuzzer,h=d.Tracker;b.prototype.handleTrackedTransaction=function(a){this.fuzzer.fuzzTransaction(a);
this.analyzer.analyzeTransaction(a)};b.prototype.handleFuzzedTransaction=function(a){this.analyzer.analyzeTransaction(a);this.fuzzerCrawler.crawlTransaction(a)};b.prototype.handleFuzzedIssue=function(a){this.reporter.reportIssue(a)};b.prototype.handleTransactionCrawledRequest=function(a){a=a.getRequest();a.make().indexOf(this.identifier)>0&&this.tracker.trackRequest(a)};b.prototype.handleAnalyzedIssue=function(a){this.reporter.reportIssue(a)};b.prototype.getReporter=function(){return this.reporter};
b.prototype.getScheduler=function(){return this.scheduler};b.prototype.getCrawler=function(){return this.crawler};b.prototype.getScope=function(){return this.scope};b.prototype.getTracker=function(){return this.tracker};b.prototype.getFuzzer=function(){return this.fuzzer};b.prototype.getAnalyzer=function(){return this.analyzer};b.prototype.getProgressor=function(){return this.progressor};b.prototype.includeBaseUrl=function(a){this.scope.includeUrl(a);var b=r.create(a.getPath()).resetLeaf().build();
this.scope.includeUrl(s.create(a).setPath(b).build())};b.prototype.launchUrl=function(a){this.includeBaseUrl(a);this.tracker.trackRequest(o.create(n.GET,a,q.HTTP11,m.BLANK,p.BLANK))};b.prototype.launchRequest=function(a){this.includeBaseUrl(a.getUrl());this.tracker.trackRequest(a)};b.prototype.analyzeTransaction=function(a){this.analyzer.analyzeTransaction(a)};b.prototype.pause=function(){this.scheduler.pause()};b.prototype.resume=function(){this.scheduler.resume()};f.MobileEngine=b})(exports);
